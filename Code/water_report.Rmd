---
title: "Water Report"
author: "Caz Bell"
date: "`r Sys.Date()`"
output:
  html_document: 
    toc: yes
    toc_float:
      collapsed: yes
      smooth_scroll: no
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(toc = TRUE, echo = FALSE, warning = FALSE, message = FALSE)

#unsure if i need toc depth here
```

# Introduction

This report details data collected from 2023-01-01 to `r Sys.Date()` by the Colorado State University (CSU) Agriculture Water Quality Program (AWQP). For more information, please contact AJ Brown at [Ansley.Brown\@colostate.edu](mailto:Ansley.Brown@colostate.edu){.email} or visit the CSU AWQP Website at <https://waterquality.colostate.edu>.




```{r, include=FALSE}
package.list <- c("ggplot2",
                  "dplyr",
                  "DT",
                  "plotly",
                  "knitr"
                  )
packageLoad <- function(packages){
  for (i in packages) {
    if (!require(i, character.only = TRUE)) {
      install.packages(i)
      library(i, character.only = TRUE)
    }
  }
}
packageLoad(package.list)

source("file-merger.R", local = knitr::knit_global())


# Set directories
report_path <- paste(dirname(getwd()), "/Example Report", sep = "")
data_path <- paste(dirname(getwd()), "/Data", sep = "")


# import data
dat <- returnAllFiles(d = data_path, export = TRUE)
#dat <- read.csv('all_files.csv', header = TRUE, stringsAsFactors = FALSE)
```




```{r}
#create grouped data frame
df_grouped <- dat %>%
    group_by(location.name, ANALYTE) %>%
    arrange(location.name)
```


# Sites

```{r}
#create data table based on counts
counts <- dat %>% 
    group_by(location.name, ANALYTE) %>% 
    summarise(count = n())
DT::datatable(counts, options = list(pageLength = length(counts$location.name)))
```


## AVRC 

Data by analyte for AVRC Star Site

```{r}
#filter to only AVRC 
AVRC <- dat %>% 
  filter(location.name == "AVRC STAR")
```


### Nitrate/Nitrite (as N)

```{r}
#Filter to single analyte
Nitrate_AVRC <- AVRC %>%
  filter(ANALYTE == "Nitrate/Nitrite (as N)")



# Create the scatter plot using Plotly
plot_ly(Nitrate_AVRC, x = ~COLLECTED, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Collection Date"),
    yaxis = list(title = "Result (mg/L)"),
    title = "Nitrate/Nitrite Results for AVRC")

#Different plot used here, date instead of method, would this be best for when we have more data? does it need to be seperated?


```



### Nitrogen, Nitrate (as N)
```{r}
Nitrogen_AVRC <- AVRC %>%
  filter(ANALYTE == "Nitrogen, Nitrate (As N)")




plot_ly(Nitrogen_AVRC, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L)"),
    scattermode = "group",
    title = "Nitrogen, Nitrate Results for AVRC")




```



### Nitrogen, Total Kjeldahl

```{r}
tkn_AVRC <- AVRC %>%
  filter(ANALYTE == "Nitrogen, Total Kjeldahl")



# Create the scatter plot using Plotly
plot_ly(tkn_AVRC, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    scattermode = "group",
    title = "TKN Resuts for AVRC"
  )




```



### Phosphorus, Total (as P)

```{r}
P_AVRC <- AVRC %>%
  filter(ANALYTE == "Phosphorus, Total (As P)")



# Create the scatter plot using Plotly
plot_ly(P_AVRC, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    scattermode = "group",
    title = "Total Phosphorus Results for AVRC"
  )




```



### Phosphorus, Total Orthophosphate (as P)

```{r}
op_AVRC <- AVRC %>%
  filter(ANALYTE == "Phosphorus, Total Orthophosphate (as P)")



# Create the scatter plot using Plotly
plot_ly(op_AVRC, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L)"),
    title = "Orthophosphate Results for AVRC")

#Different plot used here, date instead of method, would this be best for when we have more data? does it need to be seperated?


```




### Selenium

```{r}
S_AVRC <- AVRC %>%
  filter(ANALYTE == "Selenium")



# Create the scatter plot using Plotly
plot_ly(S_AVRC, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Selenium Results for AVRC")
  




```



## Berthoud

```{r}
#filter to only AVRC 
Berthoud <- dat %>% 
  filter(location.name == "Berthoud")
```

Data by analyte for Berthoud Site

### Nitrate/Nitrite (as N)

```{r}
Nitrate_B <- Berthoud %>%
  filter(ANALYTE == "Nitrate/Nitrite (as N)")



# Create the scatter plot using Plotly
plot_ly(Nitrate_B, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Nitrate/Nitrite Results for Berthoud"
  )




```



### Nitrogen, Nitrate (as N)

```{r}
Nitrogen_B <- Berthoud %>%
  filter(ANALYTE == "Nitrogen, Nitrate (As N)")



# Create the scatter plot using Plotly
plot_ly(Nitrogen_B, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Nitrogen, Nitrate Results for Bethoud"
  )




```



### Nitrogen, Total Kjeldahl

```{r}
tkn_B <- Berthoud %>%
  filter(ANALYTE == "Nitrogen, Total Kjeldahl")



# Create the scatter plot using Plotly
plot_ly(tkn_B, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "TKN Results for Berthoud"
  )




```



### Phosphorus, Total (as P)

```{r, echo =FALSE}
p_B <- Berthoud %>%
  filter(ANALYTE == "Phosphorus, Total (As P)")



# Create the scatter plot using Plotly
plot_ly(p_B, x = ~treatment.name, y = ~RESULT, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Total Phosphorus Results for Berthoud"
  )




```



### Phosphorus, Total Orthophosphate (as P)

```{r}
op_B <- Berthoud %>%
  filter(ANALYTE == "Phosphorus, Total Orthophosphate (as P)")



# Create the scatter plot using Plotly
plot_ly(op_B, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L)"),
    title = "Orthophosphate Results for Berthoud")

#Different plot used here, date instead of method, would this be best for when we have more data? does it need to be seperated?


```



### Selenium

```{r, echo= FALSE}
S_B <- Berthoud %>%
  filter(ANALYTE == "Selenium")



# Create the scatter plot using Plotly
plot_ly(S_B, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Selenium Results for Berthoud"
  )




```



## Big Hollow

```{r}
#filter to only AVRC 
BH <- dat %>% 
  filter(location.name == "Big Hollow")
```

Data by analyte for Big Hollow Site

### Nitrate/Nitrite (as N)

```{r}
Nitrate_BH <- BH %>%
  filter(ANALYTE == "Nitrate/Nitrite (as N)")



# Create the scatter plot using Plotly
plot_ly(Nitrate_BH, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Nitrate/Nitrite Results for Big Hollow"
  )




```



### Nitrogen, Nitrate (as N)

```{r}
Nitrogen_BH <- BH %>%
  filter(ANALYTE == "Nitrogen, Nitrate (As N)")



# Create the scatter plot using Plotly
plot_ly(Nitrogen_BH, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Nitrogen, Nitrate Results for Big Hollow"
  )




```



### Nitrogen, Total Kjeldahl

```{r}
tkn_BH <- BH %>%
  filter(ANALYTE == "Nitrogen, Total Kjeldahl")



# Create the scatter plot using Plotly
plot_ly(tkn_BH, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "TKN Results for Big Hollow"
  )




```



### Phosphorus, Total (as P)

```{r}
P_BH <- BH %>%
  filter(ANALYTE == "Phosphorus, Total (As P)")



# Create the scatter plot using Plotly
plot_ly(P_BH, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Total Phosphorus Results for Big Hollow"
  )




```



### Phosphorus, Total Orthophosphate (as P)

```{r}
op_BH <- BH %>%
  filter(ANALYTE == "Phosphorus, Total Orthophosphate (as P)")



# Create the scatter plot using Plotly
plot_ly(op_BH, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L)"),
    title = "Orthophosphate Results for Big Hollow")

#Different plot used here, date instead of method, would this be best for when we have more data? does it need to be seperated?


```



### Selenium

```{r}
S_BH <- BH %>%
  filter(ANALYTE == "Selenium")



# Create the scatter plot using Plotly
plot_ly(S_BH, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Seelnium Results for Big Hollow"
  )




```



## Kerbel

```{r}
#filter to only AVRC 
K <- dat %>% 
  filter(location.name == "Kerbel")
```

Data by analyte for Kerbel Site

### Nitrate/Nitrite (as N)

```{r}
Nitrate_K <- K %>%
  filter(ANALYTE == "Nitrate/Nitrite (as N)")



# Create the scatter plot using Plotly
plot_ly(Nitrate_K, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Nitrate/Nitrite Results for Kerbel"
  )




```



### Nitrogen, Nitrate (as N)

```{r}
Nitrogen_K <- K %>%
  filter(ANALYTE == "Nitrogen, Nitrate (As N)")



# Create the scatter plot using Plotly
plot_ly(Nitrogen_K, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "nitrogen, Nitrate Results for Kerbel"
  )




```



### Nitrogen, Total Kjeldahl

```{r}
tkn_K <- K %>%
  filter(ANALYTE == "Nitrogen, Total Kjeldahl")



# Create the scatter plot using Plotly
plot_ly(tkn_K, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "TKN Results for Kerbel"
  )




```


### Phosphorus, Total (as P)

```{r}
P_K <- K %>%
  filter(ANALYTE == "Phosphorus, Total (As P)")



# Create the scatter plot using Plotly
plot_ly(P_K, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Total Phosphorus Results for Kerbel"
  )




```



### Phosphorus, Total Orthophosphate (as P)

```{r}
op_K <- K %>%
  filter(ANALYTE == "Phosphorus, Total Orthophosphate (as P)")



# Create the scatter plot using Plotly
plot_ly(op_K, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L)"),
    title = "Orthophosphate Results for Kerbel")

#Different plot used here, date instead of method, would this be best for when we have more data? does it need to be seperated?


```



### Selenium

```{r}
S_K <- K %>%
  filter(ANALYTE == "Selenium")



# Create the scatter plot using Plotly
plot_ly(S_K, x = ~method.name, y = ~RESULT, color = ~treatment.name, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Selenium Results for Kerbel"
  )




```



## Yampa

```{r}
#filter to only Yampa
Y <- dat %>% 
  filter(location.name == "Yampa")
```

Data by analyte for Yampa Site

### Nitrate (as N)

```{r}
Nitrate_Y <- Y %>%
  filter(ANALYTE == "NITRATE AS N")



# Create the scatter plot using Plotly
plot_ly(Nitrate_Y, x = ~method.name, y = ~RESULT, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Nitrate Results for Yampa"
  )




```



### Nitrite (as N)

```{r}
Nitrite_Y <- Y %>%
  filter(ANALYTE == "NITRITE AS N")



# Create the scatter plot using Plotly
plot_ly(Nitrite_Y, x = ~method.name, y = ~RESULT, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Nitrite Results for Yampa"
  )




```



### Orthophosphate (as P)

```{r}
op_Y <- Y %>%
  filter(ANALYTE == "ORTHOPHOSPHATE AS P")



# Create the scatter plot using Plotly
plot_ly(op_Y, x = ~method.name, y = ~RESULT, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Orthophosphate Results for Yampa"
  )




```



### Total Phosphorus

```{r}
P_Y <- Y %>%
  filter(ANALYTE == "TOTAL PHOSPHORUS")



# Create the scatter plot using Plotly
plot_ly(P_Y, x = ~method.name, y = ~RESULT, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Total Phosphours Results for Yampa"
  )




```



### Selenium

```{r}
S_Y <- Y %>%
  filter(ANALYTE == "SELENIUM")



# Create the scatter plot using Plotly
plot_ly(S_Y, x = ~method.name, y = ~RESULT, type = "scatter") %>%
  layout(
    xaxis = list(title = "Method"),
    yaxis = list(title = "Result (mg/L"),
    title = "Selenium Results for Yampa"
  )




```



# Raw Data




```{r}
datatable(df_grouped, colnames = c('Sample ID', 'Lab ID', 'Method', 'CAS Number', 'Analyte', 'Result', 'Units', 'Dilution', "Results Reported To", 'MDL', 'RL', 'Report Basis', 'Moisture (%)', 'Solid (%)', 'Non detect', 'Duplicate', 'Location', 'Treatment', 'Method Name', 'Event Type', 'Lab ID', 'Matrix', 'Collection Date', 'Recieved Date', 'Hold Time', 'Flag'))
```

